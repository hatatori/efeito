<style id="styl2"> 
	*{transition: 1s;};
	body{text-align: center;}
</style>



<style id="styl">

	@font-face {
		font-family: math;
		src: url(fonts/cmunrm.ttf);
	}
	

	*{
		outline: none;
		/*font-family: "Times New Roman", Times, serif;*/
		word-wrap: none;
		white-space: nowrap;
		border: none;
		padding: 0;
		margin: 0;
		font-family: math
	}


	body{
		font-size: 30;
		overflow-x: hidden;
		/*font-size: 90*/
	}
	
	.some,.mostra{
		overflow: hidden;
		display: inline-flex;
		
	}

	.mostra{
		/*background-color: blue*/
	}

	.zero{max-width: 0px}

	.invisible{display: none}
	.dark,.dark *{
		color: white;
		background-color: black;
	}

	label{font-size: 12;vertical-align: middle;}
	input{vertical-align: middle;}
	#conteudo{padding: 30}
</style>



<!-- # some -->
<!-- @ aparece -->

<div id="conteudo">

	<label onclick="theme()">Tema dark<input type="checkbox" name="" id="tema"></label>
	<label onclick="themeCenter()">Tema dark<input type="checkbox" name="" id="temaC"></label>

	<br><br>
	<label>Tempo em ms</label><br>
	<input id="tm" name="" value="1000" placeholder="tempo em segundos">
	<br><br>
	<textarea spellcheck="false" id="txt" style="width: 100%;height: 100">!#negação#!!# do#!!# se#!!# então#!!@p→q@!
p!#→#!!@ ^ @!q!@'@!
!#p ^ q'#!!@Exemplo@!
!#Exemplo#!!@p→q@!
!#p#!!@José usa o fone@!→!#q#!!@Maria não corre@!
!@Se @!José usa o fone!#→#!!@, então @!Maria não corre
!#Se #!José usa o fone!#, então #!!@ e @!Maria!# não#! corre
</textarea>
	<br><br>
	<div id="efeito" class="invisible">!#negação#!!# do#!!# se#!!# então#!!@p→q@!
p!#→#!!@ ^ @!q!@'@!
!#p ^ q'#!!@Exemplo@!
!#Exemplo#!!@p→q@!
!#p#!!@José usa o fone@!→!#q#!!@Maria não corre@!
!@Se @!José usa o fone!#→#!!@, então @!Maria não corre
!#Se #!José usa o fone!#, então #!!@ e @!Maria!# não#! corre
</div>

	<div id="quadro"></div>

	<canvas id="ctx"></canvas>

</div>



<script>

	n = -1

	function theme(){
		if(tema.checked)
			document.body.classList.add("dark")
		else
			document.body.classList.remove("dark")
	}

	function themeCenter(){
		if(temaC.checked)
			document.body.style.textAlign="center"
		else
			document.body.style.textAlign="left"
	}


	function render(){

		a = efeito.innerHTML.split("\n").map(e=> "<div class='eita'>"+e+"</div>" ).join("")

		a = a.replace(/!#/g,"<div class='some'>").replace(/#!/g,"</div>")
		a = a.replace(/!@/g,"<div class='mostra'>").replace(/@!/g,"</div>")

		quadro.innerHTML = a

		function sumirTudo(){
			x = quadro.querySelectorAll("div")
			for(i of x){
				if(i.className != "some" && i.className != "mostra" )
					i.style.display="none"
			}
		}

		function mostrarPrimeiro(){
			x = quadro.querySelectorAll("div")
			x[0].removeAttribute("style")
		}


		function sSome(div){
			d = div.querySelectorAll(".some")
			for(i of d){
				i.style.width = 0
			}
		}

		function resSome(div){
			d = div.querySelectorAll(".some")
			for(i of d){
				i.removeAttribute('style')
				i.style.width = parseInt(i.getAttribute('sw'))
			}
		}

		function sMostra(div){
			d = div.querySelectorAll(".mostra")

			for(i of d){
				i.style.width = parseInt(i.getAttribute("sw"))
			}
		}

		function resMostra(div){
			d = div.querySelectorAll(".mostra")
			for(i of d){
				i.style.width = 0
			}
		}

		function setarTamanhos(){
			xsome = quadro.querySelectorAll(".some")
			xmostra = quadro.querySelectorAll(".mostra")

			for(i of xsome){
				i.innerHTML = i.innerHTML.replace(/ /g,"&nbsp;")
				i.setAttribute("sw",parseInt(i.offsetWidth))
				i.style.width=i.offsetWidth
			}

			for(j of xmostra){
				j.innerHTML = j.innerHTML.replace(/ /g,"&nbsp;")
				j.setAttribute("sw",parseInt(j.offsetWidth))
				j.style.width = 0
			}
		}


		x = quadro.querySelectorAll("div")
		xsome = quadro.querySelectorAll(".some")

		setarTamanhos()
		sumirTudo()
		mostrarPrimeiro()

		eit = document.querySelectorAll(".eita")

		tm.onkeyup=function(e){
			styl2.innerHTML = "*{transition: "+this.value/1000+"s}"
		}

		window.onkeyup=function(e){

			temp = parseFloat(tm.value)
			// styl.innerHTML = styl.innerHTML.replace(/transition:.+?;/,"transition: "+(temp/1000)+"s")

			if(e.key == 0){
				n = -1
				render()
			}

			if(e.key == "ArrowRight"){

				n++

				if(n <= eit.length-1){

					sSome(eit[n])
					sMostra(eit[n])

					if(n < eit.length-2){
						setTimeout(()=>{			
							eit[n].style.display="none"
							eit[n+1].style.display="inline"
						},parseInt(tm.value))
					}
				}
			}

			if(e.key == "ArrowLeft"){

				if(n>-1){	
					sumirTudo()
					eit[n].style.display="block"
					eit[n+1].style.display="none"

					setTimeout(()=>{
						resSome(eit[n+1])
						resMostra(eit[n+1])
					},0)

					n--
				}
			}

			console.log(n)
		}
	}render()

	txt.onkeyup=function(e){
		efeito.innerHTML = this.value
		n=-1
		render()
	}

</script>
